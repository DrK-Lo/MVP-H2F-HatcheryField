Folder for code related to parental genetics structure, F stats, outliers, and SNP annotation

| File | Function | Datasets used | Datasets produced |
|------|----------|---------------|-------------------|
| updated_genetics_experimental.R | Builds a clean genotype matrix from raw VCF files, merges genotype data with project metadata, and runs population genetic analyses (PCA and ancestry estimation) on the experimental subset. | **Genotype data:** VCF files from Affymetrix OysterCVI200K SNP chip (PlDNA 1–13 + global recall); SNP annotation file (`20240719_mutmatrix.rds`)<br><br>**Sequencing metadata:** Sample tables with pass/fail, call rates, DQC, heterozygosity per plate<br><br>**Project metadata:** CSVs for experimental broodstock (phenotypes) | **Genotype matrices (RDS):** Imputed (160 × 154,102) and LD-thinned experimental<br><br>**Metadata (RDS/CSV):** Merged individual data with sequencing QC + project metadata + environment<br><br>**Analyses:** PCA (6 axes), SNMF ancestry (K=2) |
| exp_structure_analysis.Rmd | Visualizes parental genetic structure for the H2F manuscript. Plots PCA (colored by plate for batch effects and by population), runs SNMF ancestry analysis (K=2), creates horizontal ancestry barplot, ancestry pie chart map on US coastline, and generates a Chesapeake Bay inset map showing the two common garden sites. | **From updated_genetics_experimental.R:**<br>`20250604_pca_data_exp.csv`, `20250604_FULLSNPs_exp.rds`, `20250604_THINNEDSNPs_exp.rds`, `20250604_samp_full_subset_exp.rds`<br><br>**Project metadata:**<br>`MVP23-FieldBags-spawn_trt2.csv` (site coordinates) | **Figures (PDF):**<br>`Fig1A_ancestry_map.pdf`, `Fig1A_inset_map.pdf`, `FigS1_snmf_ancestry.pdf`<br><br>**Intermediate files:**<br>`20250204geno_imputedfile_exp.geno`, `20250204geno_imputedfile_exp.snmfProject` |
| muts_reannotation.Rmd | Re-annotates all 195,025 SNPs in the mutation-level data frame using the *C. virginica* GFF3 annotation from Ensembl and queries Ensembl Metazoa (biomaRt) for gene descriptions and GO terms. Increases annotation coverage from 26,125 to 142,178 SNPs with gene IDs. Collapses multi-gene SNPs into one row per SNP with semicolon-separated entries. | **From updated_genetics_experimental.R:**<br>`20250604_mutmatrix_PASS.rds` (195,025 SNPs)<br><br>**External:**<br>`Crassostrea_virginica_gca002022765v4.C_virginica_3.0.62.gff3` (Ensembl genome annotation), Ensembl Metazoa biomaRt database | **Supplementary file (CSV):**<br>`all_SNPs_reannotated.csv` (195,025 SNPs with gene IDs, descriptions, GO IDs, and GO terms; one row per SNP with semicolon-separated multi-gene entries) |
| Fstats_experimental.Rmd | Generates supplementary SNP files (annotated SNP info CSV and imputed genotype VCF). Calculates pairwise Fst between populations using hierfstat on the LD-thinned SNP set, runs basic population genetic statistics (Ho, Hs, allelic richness) on the full SNP set, and identifies Fst outlier loci using OutFLANK. Produces a pairwise Fst heatmap. | **From updated_genetics_experimental.R:**<br>`20250606_FULLSNPs_exp_labeled.rds`, `20250606_THINNEDSNPs_exp_labeled.rds`, `20250604_FULLmuts_exp.rds`, `20250604_samp_full_subset_exp.rds` | **Supplementary files:**<br>`2-supplementary_snp_info.csv` (Supp File 2),<br>`3-supplementary_genotypes.vcf` (Supp File 3)<br><br>**Results:**<br>`20250606_fst_results.rds` (pairwise Fst matrix),<br>`outflank_results.csv` (per-SNP Fst, p-values, outlier flags, chromosome positions, gene annotations),<br>`parent_genetic_effects.csv` (per-population avg Ho, Hs, allelic richness) |
| GO_experimental.Rmd | Re-annotates OutFLANK Fst outlier SNPs with gene IDs (GFF3 + Ensembl Metazoa biomaRt), generates gene lists for ShinyGO enrichment analysis, imports ShinyGO results, creates a Manhattan plot of Fst with highlighted GO-enriched pathways and labeled candidate genes, and creates a lollipop plot of enriched GO pathways. Also checks for overlap with putative Dermo resistance genes from Wang et al. 2025. | **From Fstats_experimental.Rmd:**<br>`outflank_results.csv`<br><br>**External:**<br>GFF3 annotation, Ensembl Metazoa biomaRt, ShinyGO outputs (`shinyGO_enriched.csv`, `shinyGO_genes.csv`) | **Figures (PDF):**<br>`Fig5A_fst_manhattan_plot.pdf`, `Fig5B_GO_lollipop_plot.pdf`<br><br>**Supplementary files (CSV):**<br>`5-full_SNPs_outliers_annotated.csv` (Supp File 5: all SNPs with outlier status, gene IDs, descriptions, GO terms) |
