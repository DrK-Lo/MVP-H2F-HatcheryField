### Environmental data & parental genetics figure updates (for the meeting following 3/14/25)

Objectives: 
1. Madeline making new PCAs for environment of origin figure, including high/low salinity/temp stress day (also RDA if there is time, but not a priority)
2. Madeline will make correlation map looking at the environmental parameters (min/max/mean temp and salinity) in relation to all other environmental parameters

# Correlation matrix for environmental data
## includes all environment-of-origins for the experimental parentals + environments at the selection lines LOLA and DEBY + environments at the field sites LEW and YORK
![Screenshot 2025-03-24 at 4 59 49 PM](https://github.com/user-attachments/assets/037fde5f-f9d3-47ed-acdc-67092ab2d586)

# PCA plot for non-correlated environmental variables
###  correlations between the PC axis and predictors with the X_pc that has JUST our four non-correlated environmental variables
`> round(scores(pred.pca, choices = 1:4, display = "species", scaling = 0), digits =3)
                          PC1    PC2    PC3    PC4
Mean_max_Salinity_ppt  -0.543  0.393 -0.530 -0.520
Mean_min_Salinity_ppt  -0.479  0.353  0.802 -0.052
Mean_max_temperature_C -0.282 -0.814  0.159 -0.482
Mean_min_temperature_C -0.630 -0.242 -0.224  0.703
attr(,"const")
[1] 4.973795`

![Screenshot 2025-03-25 at 10 50 28 AM](https://github.com/user-attachments/assets/86c809aa-7687-413b-b426-015fd5d78081)
### the strongest correlations with PC1 are Mean_min_temperature_C and Mean_max_Salinity_ppt
### the strongest correlations with PC2 are Mean_max_temperature_C (by a landslide) and then Mean_max_Salinity_ppt
### Mean_max_Salinity_ppt is really driving a lot of divergence in the PCA

# original environmental correlation matrix showing ALL variables
## many are correlated (which is why we thinned) to just min/max temperature and salinity
<img width="1189" alt="Screenshot 2025-03-18 at 8 44 15 AM" src="https://github.com/user-attachments/assets/1a8a36f1-cc79-4315-830b-26e11fc70acc" />

# Genetic PCAs with environmental similarity clusters (LEA tutorial)
<img width="869" alt="Screenshot 2025-03-24 at 11 53 35 PM" src="https://github.com/user-attachments/assets/869da210-3442-4c59-b8c9-87b9679f5839" />
<img width="863" alt="Screenshot 2025-03-24 at 11 54 50 PM" src="https://github.com/user-attachments/assets/6e3b3715-b92f-447f-b0cc-786bc5d04c8a" />
<img width="868" alt="Screenshot 2025-03-24 at 11 55 08 PM" src="https://github.com/user-attachments/assets/4bc13314-649e-493c-9ecd-d4ba7b93cd88" />
<img width="1290" alt="Screenshot 2025-03-24 at 11 55 30 PM" src="https://github.com/user-attachments/assets/52cce931-e700-4032-a34a-8623062c390e" />


# environmental data analysis
## PCAs for the environment of origin sites (including ALL data, including correlated variables)

<img width="908" alt="Screenshot 2025-03-24 at 11 39 16 PM" src="https://github.com/user-attachments/assets/67e209e9-ad2c-493d-8c38-dff75d28e577" />

<img width="871" alt="Screenshot 2025-03-24 at 11 29 53 PM" src="https://github.com/user-attachments/assets/3697f520-2b94-4bfd-96db-da1530c54abf" />

<img width="874" alt="Screenshot 2025-03-24 at 11 31 08 PM" src="https://github.com/user-attachments/assets/9e52c736-d940-44bf-9b8f-ef29ff4848e4" />

`pc_combined <- prcomp(combined_pca_data, scale = TRUE)`

`combined_pca_data <- combined_data[, c("Mean_Annual_Salinity_ppt", "Mean_max_Salinity_ppt", "Mean_min_Salinity_ppt", "high_sal_stress_days", "low_sal_stress_days", "frac_high_sal_stress_days", "frac_low_sal_stress_days", "Salinity_st_dev", "Mean_Annual_Temperature_C", "Mean_max_temperature_C", "Mean_min_temperature_C", "Temperature_st_dev", "high_temp_stress_days", "frac_high_temp_stress_days")]`

# lfmm2 and gene ontology results for the experimental adults
<img width="856" alt="Screenshot 2025-03-24 at 11 57 47 PM" src="https://github.com/user-attachments/assets/2ffb6ce9-2628-425e-bcdf-57e52a8e7a6a" />
<img width="872" alt="Screenshot 2025-03-24 at 11 58 38 PM" src="https://github.com/user-attachments/assets/64ac7111-2396-4bf5-816f-0559fad5af62" />

`qv_lfmm2  <- qvalue::qvalue(pv_lfmm2, fdr.level = 0.05)`
# Orange line: Bonferonni multiple testing threshold for significance
`abline(h = -log10(0.1/ncol(Y)), col = "orange")`

## 9192 SNPs detected as significant outliers from lfmm2 analysis (only 823 mapped using ShinyGO)
<img width="981" alt="Screenshot 2025-03-25 at 12 02 53 AM" src="https://github.com/user-attachments/assets/5a89d871-ad87-497f-b324-230e6f35e89a" />

![barplot](https://github.com/user-attachments/assets/1899c5c2-32dd-4813-b5d1-39fe2f20a17e)

<img width="894" alt="Screenshot 2025-03-25 at 12 07 52 AM" src="https://github.com/user-attachments/assets/f487a16d-ff1e-4001-a2c4-de8173f43ac1" />

`paste(lfmm2_outliers$gene, collapse = " ")`
LOC111119377 LOC111100985 LOC111116034 LOC111111995 LOC111127416 LOC111127416 LOC111119818 LOC111100637 LOC111100637 LOC111125338 LOC111128784 LOC111130848 LOC111109321 LOC111113745 LOC111134162 LOC111137407 LOC111123922 LOC111118051 LOC111100849 LOC111109994 LOC111111509 LOC111123766 LOC111099722 LOC111099722 LOC111124829 LOC111120685 LOC111102738 LOC111136085 LOC111105322 LOC111105313 LOC111103542 LOC111103542 LOC111103659 LOC111124867 LOC111128747 LOC111123957 LOC111134337 LOC111099049 LOC111102570 LOC111135947 LOC111103740 LOC111109612 LOC111137315 LOC111102415 LOC111107083 LOC111134008 LOC111114331 LOC111138494 LOC111119911 LOC111119922 LOC111116839 LOC111101232 LOC111114718 LOC111114718 LOC111127723 LOC111116352 LOC111116352 LOC111118494 LOC111119772 LOC111130039 LOC111119149 LOC111119246 LOC111100065 LOC111127875 LOC111102528 LOC111119701 LOC111102987 LOC111102987 LOC111136587 LOC111127225 LOC111127225 LOC111108151 LOC111135504 LOC111135658 LOC111135564 LOC111135589 LOC111114174 LOC111132859 LOC111101837 LOC111117925 LOC111118554 LOC111135003 LOC111135003 LOC111129455 LOC111099775 LOC111127323 LOC111131784 LOC111131784 LOC111131784 LOC111099143 LOC111099143 LOC111128934 LOC111135447 LOC111113431 LOC111123652 LOC111120600 LOC111119678 LOC111119293 LOC111120482 LOC111121894 LOC111119625 LOC111120783 LOC111121541 LOC111118916 LOC111122078 LOC111120083 LOC111120083 LOC111120180 LOC111119193 LOC111119162 LOC111119400 LOC111119400 LOC111121220 LOC111120642 LOC111120093 LOC111118955 LOC111118955 LOC111118957 LOC111119579 LOC111120200 LOC111120773 LOC111121086 LOC111122374 LOC111121365 LOC111120215 LOC111118072 LOC111121397 LOC111120831 LOC111122429 LOC111118451 LOC111120231 LOC111120956 LOC111119688 LOC111121530 LOC111119542 LOC111119713 LOC111121601 LOC111119539 LOC111121052 LOC111122413 LOC111122413 LOC111121780 LOC111118137 LOC111120585 LOC111120753 LOC111119438 LOC111119451 LOC111118593 LOC111118566 LOC111118640 LOC111120141 LOC111118261 LOC111117953 LOC111118237 LOC111122044 LOC111117852 LOC111122252 LOC111122250 LOC111120107 LOC111120871 LOC111119634 LOC111120927 LOC111119516 LOC111119108 LOC111119359 LOC111122179 LOC111120660 LOC111118541 LOC111118539 LOC111121212 LOC111119166 LOC111121262 LOC111120701 LOC111119953 LOC111120754 LOC111118275 LOC111126675 LOC111123162 LOC111122932 LOC111122577 LOC111126116 LOC111126041 LOC111127117 LOC111122745 LOC111123201 LOC111123008 LOC111123022 LOC111127665 LOC111123057 LOC111126151 LOC111127509 LOC111125433 LOC111127501 LOC111127570 LOC111127572 LOC111127036 LOC111122722 LOC111126047 LOC111126429 LOC111126285 LOC111127402 LOC111126343 LOC111123319 LOC111125474 LOC111126052 LOC111127533 LOC111125473 LOC111125835 LOC111124176 LOC111124899 LOC111123223 LOC111123544 LOC111122494 LOC111124862 LOC111124862 LOC111123194 LOC111124927 LOC111125881 LOC111127045 LOC111123699 LOC111125842 LOC111123254 LOC111122601 LOC111123502 LOC111124621 LOC111125791 LOC111125083 LOC111124583 LOC111123896 LOC111125107 LOC111126804 LOC111123490 LOC111123091 LOC111123090 LOC111123090 LOC111122957 LOC111127338 LOC111127518 LOC111126188 LOC111126391 LOC111126538 LOC111126156 LOC111122853 LOC111126375 LOC111125981 LOC111125968 LOC111125949 LOC111125945 LOC111124575 LOC111125040 LOC111125214 LOC111125808 LOC111123590 LOC111124875 LOC111127096 LOC111127096 LOC111126534 LOC111126439 LOC111122645 LOC111122700 LOC111123837 LOC111124327 LOC111125932 LOC111124724 LOC111122663 LOC111123689 LOC111123689 LOC111127158 LOC111126164 LOC111126368 LOC111126053 LOC111126505 LOC111123236 LOC111126735 LOC111126735 LOC111124021 LOC111124634 LOC111122815 LOC111122815 LOC111122817 LOC111126107 LOC111123792 LOC111124019 LOC111124356 LOC111122571 LOC111123584 LOC111127439 LOC111127443 LOC111126830 LOC111125129 LOC111123155 LOC111123155 LOC111124479 LOC111123069 LOC111123703 LOC111126641 LOC111123080 LOC111125078 LOC111122597 LOC111122791 LOC111126211 LOC111125145 LOC111127341 LOC111123601 LOC111124637 LOC111125671 LOC111127264 LOC111127540 LOC111122617 LOC111126150 LOC111124578 LOC111127365 LOC111122869 LOC111126226 LOC111122691 LOC111126282 LOC111125553 LOC111124713 LOC111124712 LOC111128920 LOC111131536 LOC111131137 LOC111130898 LOC111128025 LOC111128424 LOC111131449 LOC111131449 LOC111128509 LOC111131861 LOC111130347 LOC111129187 LOC111129901 LOC111129823 LOC111130102 LOC111129961 LOC111131415 LOC111128101 LOC111127788 LOC111130020 LOC111129889 LOC111129888 LOC111127964 LOC111130884 LOC111130727 LOC111130676 LOC111130274 LOC111129475 LOC111131153 LOC111129270 LOC111130050 LOC111129969 LOC111130302 LOC111129345 LOC111127976 LOC111127976 LOC111127858 LOC111130133 LOC111130400 LOC111131386 LOC111130611 LOC111129451 LOC111129851 LOC111128258 LOC111130954 LOC111128418 LOC111130548 LOC111131725 LOC111129313 LOC111130146 LOC111127889 LOC111131077 LOC111129651 LOC111129930 LOC111128202 LOC111130852 LOC111129865 LOC111130850 LOC111130850 LOC111131332 LOC111129966 LOC111130617 LOC111127771 LOC111130859 LOC111130068 LOC111129299 LOC111131875 LOC111130718 LOC111128344 LOC111130615 LOC111128945 LOC111127829 LOC111127933 LOC111131367 LOC111128273 LOC111130444 LOC111131793 LOC111128923 LOC111130119 LOC111130009 LOC111131142 LOC111137334 LOC111135147 LOC111137256 LOC111137505 LOC111137602 LOC111132916 LOC111132955 LOC111134839 LOC111138351 LOC111136807 LOC111136608 LOC111133392 LOC111135958 LOC111135769 LOC111136732 LOC111135872 LOC111135872 LOC111132034 LOC111133767 LOC111137029 LOC111137029 LOC111136548 LOC111137901 LOC111135774 LOC111135619 LOC111136599 LOC111133996 LOC111133503 LOC111135630 LOC111136511 LOC111099057 LOC111132901 LOC111133890 LOC111135490 LOC111135009 LOC111134699 LOC111137562 LOC111137899 LOC111133702 LOC111137794 LOC111135319 LOC111135319 LOC111137290 LOC111137290 LOC111133161 LOC111133157 LOC111136506 LOC111137921 LOC111134056 LOC111134056 LOC111134058 LOC111135832 LOC111134685 LOC111134386 LOC111134053 LOC111134053 LOC111136391 LOC111134889 LOC111138450 LOC111133829 LOC111133359 LOC111137330 LOC111136741 LOC111133713 LOC111135285 LOC111135286 LOC111135286 LOC111132811 LOC111132230 LOC111135729 LOC111136648 LOC111133865 LOC111135988 LOC111136322 LOC111132210 LOC111133807 LOC111137552 LOC111137415 LOC111132263 LOC111099105 LOC111137337 LOC111132281 LOC111099173 LOC111099173 LOC111135230 LOC111136402 LOC111133465 LOC111134696 LOC111136520 LOC111133515 LOC111135549 LOC111132115 LOC111133957 LOC111135484 LOC111136464 LOC111137929 LOC111134329 LOC111136255 LOC111134305 LOC111138334 LOC111137086 LOC111137086 LOC111134587 LOC111134006 LOC111133027 LOC111132364 LOC111133834 LOC111133170 LOC111099039 LOC111136326 LOC111137331 LOC111137331 LOC111132133 LOC111132133 LOC111135125 LOC111135125 LOC111136469 LOC111136615 LOC111133384 LOC111132390 LOC111099032 LOC111135810 LOC111132411 LOC111132411 LOC111134941 LOC111138000 LOC111138206 LOC111138189 LOC111137299 LOC111137299 LOC111136597 LOC111133449 LOC111133449 LOC111134863 LOC111135545 LOC111132399 LOC111137582 LOC111137806 LOC111136126 LOC111136124 LOC111134463 LOC111136737 LOC111136737 LOC111136226 LOC111132137 LOC111134718 LOC111132432 LOC111135082 LOC111135075 LOC111132438 LOC111135229 LOC111138521 LOC111136089 LOC111135393 LOC111099219 LOC111138227 LOC111137410 LOC111133140 LOC111137422 LOC111133033 LOC111135401 LOC111138423 LOC111137257 LOC111137699 LOC111133319 LOC111132593 LOC111133674 LOC111136639 LOC111134879 LOC111137379 LOC111136384 LOC111135066 LOC111134112 LOC111135893 LOC111137313 LOC111135239 LOC111134722 LOC111134722 LOC111137277 LOC111134558 LOC111136922 LOC111136921 LOC111138042 LOC111135363 LOC111132107 LOC111135070 LOC111133758 LOC111138066 LOC111137543 LOC111136669 LOC111134680 LOC111134833 LOC111134834 LOC111137572 LOC111138282 LOC111135448 LOC111135241 LOC111135911 LOC111136903 LOC111134464 LOC111136074 LOC111135347 LOC111134542 LOC111134553 LOC111134548 LOC111134529 LOC111134531 LOC111134544 LOC111134544 LOC111134536 LOC111137342 LOC111132192 LOC111135634 LOC111137638 LOC111134435 LOC111134995 LOC111134575 LOC111134516 LOC111132543 LOC111134203 LOC111134203 LOC111138403 LOC111136433 LOC111136598 LOC111132865 LOC111135439 LOC111135439 LOC111135612 LOC111135602 LOC111132554 LOC111135606 LOC111135598 LOC111135598 LOC111135601 LOC111135610 LOC111133429 LOC111133197 LOC111132130 LOC111133851 LOC111134659 LOC111132202 LOC111133427 LOC111135826 LOC111136831 LOC111136431 LOC111134038 LOC111136978 LOC111135714 LOC111138076 LOC111138076 LOC111137869 LOC111132862 LOC111135333 LOC111138292 LOC111138469 LOC111135108 LOC111135558 LOC111136895 LOC111133164 LOC111133164 LOC111132873 LOC111136874 LOC111138001 LOC111099118 LOC111137837 LOC111133659 LOC111136750 LOC111135565 LOC111137096 LOC111133508 LOC111136674 LOC111136889 LOC111134101 LOC111133034 LOC111136430 LOC111136430 LOC111135327 LOC111133419 LOC111137747 LOC111132615 LOC111135710 LOC111136667 LOC111136667 LOC111133641 LOC111134460 LOC111134460 LOC111133903 LOC111133905 LOC111133060 LOC111099171 LOC111132081 LOC111133547 LOC111132949 LOC111133424 LOC111135494 LOC111133806 LOC111132206 LOC111138112 LOC111134977 LOC111134987 LOC111134982 LOC111134981 LOC111134984 LOC111134984 LOC111099040 LOC111135851 LOC111101099 LOC111099651 LOC111100661 LOC111101030 LOC111100517 LOC111100220 LOC111102308 LOC111100025 LOC111100570 LOC111100604 LOC111102110 LOC111100587 LOC111100610 LOC111100620 LOC111101052 LOC111101010 LOC111100352 LOC111101054 LOC111099547 LOC111099736 LOC111099718 LOC111100714 LOC111100630 LOC111100580 LOC111100628 LOC111101263 LOC111099612 LOC111100502 LOC111100188 LOC111099443 LOC111100051 LOC111100522 LOC111102132 LOC111101374 LOC111100143 LOC111099479 LOC111099479 LOC111102307 LOC111102307 LOC111100047 LOC111101036 LOC111101152 LOC111101861 LOC111101484 LOC111100638 LOC111100638 LOC111101286 LOC111101373 LOC111101035 LOC111100356 LOC111100836 LOC111100561 LOC111101279 LOC111100347 LOC111101110 LOC111100556 LOC111101225 LOC111101225 LOC111099713 LOC111100330 LOC111099994 LOC111100963 LOC111099503 LOC111099773 LOC111101203 LOC111099426 LOC111100478 LOC111100466 LOC111100467 LOC111100165 LOC111101289 LOC111102186 LOC111103801 LOC111103801 LOC111104066 LOC111104066 LOC111104069 LOC111104068 LOC111104068 LOC111104062 LOC111102475 LOC111102475 LOC111102529 LOC111103059 LOC111104055 LOC111104055 LOC111102798 LOC111102798 LOC111103367 LOC111105403 LOC111103136 LOC111104987 LOC111103810 LOC111105074 LOC111103778 LOC111104629 LOC111103449 LOC111104670 LOC111102719 LOC111102881 LOC111102412 LOC111104326 LOC111104801 LOC111103264 LOC111104041 LOC111102554 LOC111110684 LOC111110684 LOC111110315 LOC111108691 LOC111108743 LOC111106527 LOC111107234 LOC111106216 LOC111109578 LOC111106521 LOC111110384 LOC111105839 LOC111107274 LOC111107274 LOC111107792 LOC111108081 LOC111106298 LOC111107140 LOC111107483 LOC111108186 LOC111105780 LOC111106650 LOC111109892 LOC111107393 LOC111109179 LOC111106090 LOC111109729 LOC111108697 LOC111108359 LOC111109272 LOC111109272 LOC111107078 LOC111108376 LOC111108150 LOC111114889 LOC111111223 LOC111110860 LOC111115343 LOC111114617 LOC111115931 LOC111113363 LOC111112508 LOC111113178 LOC111111642 LOC111114038 LOC111112551 LOC111113393 LOC111114616 LOC111115092 LOC111112947 LOC111112791 LOC111115775 LOC111115117 LOC111114833 LOC111113408 LOC111111211 LOC111113249 LOC111111153 LOC111112807 LOC111112587 LOC111112585 LOC111113114 LOC111114163 LOC111114902 LOC111114937 LOC111115836 LOC111115836 LOC111112044 LOC111111339 LOC111111339 LOC111112914 LOC111113328 LOC111114304 LOC111112160 LOC111114349 LOC111117514 LOC111117622 LOC111117191 LOC111117016 LOC111117667 LOC111116709

# RDA analysis for the experimental adults 
