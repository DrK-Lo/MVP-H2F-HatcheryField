# Comparing ShinyGO analyses for genes detected as outliers in lfmm2 and outflank

## Complete tldr
![Screenshot 2025-03-28 at 11 59 39 AM](https://github.com/user-attachments/assets/b7bb48ae-126d-4dc9-891f-32b5a092a914)

## relevant papers/citations

1. (Griffiths 2021)[https://royalsocietypublishing.org/doi/full/10.1098/rspb.2020.3118]
2. (Sirovy 2023)[https://journals.biologists.com/jeb/article/226/14/jeb244315/324852/Population-specific-responses-in-eastern-oysters]
3. (Eierman and Hare 2013)[https://www.sciencedirect.com/science/article/pii/S0022098113003067]
4. (Unpublished conference abstract)[https://mainemaritime.edu/ocean-studies/wp-content/uploads/sites/29/2024/01/Effects-of-thermal-stress-on-heat-shock-protein-gene-expression.pdf]
5. (Encomio 2007)[https://www.int-res.com/abstracts/dao/v76/n3/p251-260/]

## Selecting genes from lfmm2: bonferroni or q-values?
#### Bonferroni line is more conservative, q-values fdr threshold can be set at 0.01 (middle ground) or 0.05 (most relaxed)
tldr: I think that the q-value with fdr = 0.01 is probably the best "middle-ground" option. The bonferroni line is too conservative and only returns 117 SNPs. However, it's worth noting that the q-value with fdr = 0.05 returns SNPs in quantities most similar to OutFlank (each ~9k SNPs detected as outliers, with ~800 mapping in ShinyGO). So I think it's justifiable to use q-values with fdr = 0.05 too. 

tldr quants: 
1. Bonferroni: 1570 SNPs detected as significant outliers, 117 map in ShinyGO
2. q-value with fdr = 0.01:  5397 SNPs detected as significant outliers, 453 map in ShinyGO
3. q-value with fdr = 0.05: 9192 SNPs detected as significant outliers, 893 map in ShinyGO

## Bonferroni results
#### 1570 SNPs detected as significant outliers, 117 map in ShinyGO

<img width="780" alt="bonferroni_chart" src="https://github.com/user-attachments/assets/e420febc-bf46-45d0-af4b-e6a32c30ae8f" />
<img width="1070" alt="bonferroni_genome" src="https://github.com/user-attachments/assets/b9b786cf-9218-4de6-8d94-225b2ec4fbd4" />

## q-value with fdr = 0.01 results
#### 5397 SNPs detected as significant outliers, 453 map in ShinyGO

<img width="744" alt="q_value_01_chart" src="https://github.com/user-attachments/assets/6cc76f08-9e63-4bcd-94dc-6e3f827ce2a8" />
<img width="1056" alt="q_value_01_genome" src="https://github.com/user-attachments/assets/8d1c4820-3224-4679-9f5b-15b63f43f037" />

## q-value with fdr = 0.05 results 
#### 9192 SNPs detected as significant outliers, 893 map in ShinyGO

<img width="746" alt="q_value_05_chart" src="https://github.com/user-attachments/assets/b25d4f31-6451-444e-ac94-d2a0b4d9e443" />
<img width="1071" alt="q_value_05_genome" src="https://github.com/user-attachments/assets/35d255c4-2861-41af-90d1-d4f05176455e" />

## Comparing q-value and bonferroni results

### q-value fdr = 0.05 vs q-value fdr = 0.01
![compare_q_value05_q_value01](https://github.com/user-attachments/assets/c0f8926c-9887-4d80-8c53-2ca8b73da5f3)

### q-value fdr = 0.01 vs bonferroni
![compare_bonferroni_qvalue-1](https://github.com/user-attachments/assets/16babcaa-65c9-4eba-8f27-d295f03bdb87)

### q-value fdr = 0.05 vs bonferroni
![compare_bonferroni_q_value05](https://github.com/user-attachments/assets/e1127502-af0f-4ede-bb76-89350443197e)


# OutFLANK (Fst) results

## q-value with fdr = 0.01 results
#### 6817 SNPs detected as significant outliers, map to 315 genes in ShinyGO

<img width="968" alt="Screenshot 2025-03-27 at 11 22 30 PM" src="https://github.com/user-attachments/assets/97b73b2a-b7d2-4686-a9bd-871e2a9bbb1c" />
<img width="636" alt="Screenshot 2025-03-27 at 11 23 03 PM" src="https://github.com/user-attachments/assets/e768d013-23e9-41a2-a99d-4cb342e86309" />

## q-value with fdr = 0.05 results
#### 11863 SNPs detected as significant outliers, map to 861 genes in ShinyGO

<img width="946" alt="Screenshot 2025-03-27 at 11 25 59 PM" src="https://github.com/user-attachments/assets/5375f779-40b5-41e6-a404-747dc8a1368b" />
<img width="580" alt="Screenshot 2025-03-27 at 11 26 12 PM" src="https://github.com/user-attachments/assets/5a879c50-85f3-439a-acf2-dce884c6d968" />

# Comparing Fst with lfmm2 results

## Fst vs Bonferroni SNPs
![compare_bonferroni_fst](https://github.com/user-attachments/assets/7c643d3d-b571-417a-86e9-56e5a714b1d0)

## Fst vs q-value fdr = 0.05
![compare_fst_q_value05](https://github.com/user-attachments/assets/9b350f20-45a5-4c94-b054-dd4da7635b1c)

## Fst vs q-value fdr = 0.01 
![compare_fst_q_value01](https://github.com/user-attachments/assets/c7bdae85-2f2f-4c99-8201-a623022e8680)

# Comparing overlapping results for q-values fdr = 0.01 or fdr = 0.05 and Fst

## overlapping results between q-value fdr = 0.01 and Fst
<img width="1070" alt="overlapping_genome_qvalue01_fst" src="https://github.com/user-attachments/assets/fc2f94d4-715e-40dd-a885-9bbe69ff8d89" />
<img width="753" alt="overlapping_qvalue01_fst_snps" src="https://github.com/user-attachments/assets/4f859a33-3891-48f7-9a31-4e6b09ee1d65" />

## overlapping results between q-value fdr = 0.05 and Fst
<img width="1064" alt="overlapping_genome_qvalue05_fst" src="https://github.com/user-attachments/assets/45809ebf-3900-43ea-8850-4c7e89211ea5" />
<img width="751" alt="overlapping_quavlue05_fst_snps" src="https://github.com/user-attachments/assets/434923b4-8cc9-40df-ba33-c94bbf31e0df" />


# Overlapping gene lists for ShinyGO

## Overlapping genes between Fst and lfmm2 with q-value fdr = 0.05
Overlapping SNPs for ShinyGO: 
LOC111119377 LOC111116034 LOC111111995 LOC111127416 LOC111128784 LOC111109321 LOC111137407 LOC111118051 LOC111100849 LOC111124829 LOC111120685 LOC111136085 LOC111105313 LOC111103542 LOC111128747 LOC111099049 LOC111135947 LOC111103740 LOC111109612 LOC111134008 LOC111119911 LOC111119922 LOC111101232 LOC111114718 LOC111116352 LOC111130039 LOC111119246 LOC111127875 LOC111102528 LOC111119701 LOC111102987 LOC111127225 LOC111135504 LOC111114174 LOC111132859 LOC111135003 LOC111129455 LOC111099775 LOC111131784 LOC111099143 LOC111135447 LOC111113431 LOC111119678 LOC111121894 LOC111121541 LOC111118916 LOC111120083 LOC111119193 LOC111119162 LOC111119400 LOC111121220 LOC111120642 LOC111118957 LOC111119579 LOC111120773 LOC111122374 LOC111120215 LOC111119713 LOC111122413 LOC111121780 LOC111118137 LOC111120585 LOC111122250 LOC111119634 LOC111120927 LOC111119516 LOC111120660 LOC111118541 LOC111120701 LOC111120754 LOC111118275 LOC111122932 LOC111123201 LOC111127665 LOC111123057 LOC111127509 LOC111127036 LOC111127402 LOC111126343 LOC111126052 LOC111125835 LOC111124176 LOC111123544 LOC111122494 LOC111124862 LOC111123194 LOC111125881 LOC111127045 LOC111123699 LOC111125842 LOC111123254 LOC111123502 LOC111124621 LOC111123896 LOC111126804 LOC111123090 LOC111122957 LOC111127338 LOC111126188 LOC111126391 LOC111126375 LOC111125945 LOC111124575 LOC111125214 LOC111125808 LOC111126534 LOC111126439 LOC111122645 LOC111122700 LOC111123837 LOC111122663 LOC111126505 LOC111123236 LOC111126735 LOC111124634 LOC111122815 LOC111122817 LOC111124019 LOC111122571 LOC111124479 LOC111123703 LOC111125145 LOC111122691 LOC111126282 LOC111124713 LOC111131137 LOC111130898 LOC111128509 LOC111131861 LOC111129823 LOC111130020 LOC111129888 LOC111127964 LOC111130884 LOC111130727 LOC111129475 LOC111131153 LOC111129270 LOC111129345 LOC111127858 LOC111131386 LOC111130611 LOC111129451 LOC111128258 LOC111130954 LOC111129313 LOC111130146 LOC111131077 LOC111129651 LOC111129930 LOC111130852 LOC111131332 LOC111129966 LOC111131875 LOC111128945 LOC111127829 LOC111131367 LOC111128273 LOC111130444 LOC111131793 LOC111130119 LOC111137334 LOC111135147 LOC111137256 LOC111137602 LOC111132916 LOC111132955 LOC111135958 LOC111135872 LOC111132034 LOC111136548 LOC111135490 LOC111137562 LOC111137899 LOC111135319 LOC111134058 LOC111135832 LOC111134889 LOC111138450 LOC111133359 LOC111135286 LOC111135729 LOC111136648 LOC111133865 LOC111132210 LOC111133807 LOC111137552 LOC111137415 LOC111099173 LOC111133465 LOC111134696 LOC111132115 LOC111135484 LOC111136464 LOC111134006 LOC111136326 LOC111137331 LOC111132133 LOC111136469 LOC111136615 LOC111133384 LOC111132390 LOC111134941 LOC111138000 LOC111138189 LOC111137299 LOC111136597 LOC111133449 LOC111136737 LOC111134718 LOC111132432 LOC111138521 LOC111099219 LOC111137410 LOC111133033 LOC111138423 LOC111137699 LOC111133319 LOC111132593 LOC111134879 LOC111136384 LOC111135893 LOC111137313 LOC111135239 LOC111134722 LOC111137277 LOC111136922 LOC111135363 LOC111137543 LOC111136669 LOC111134680 LOC111134834 LOC111135911 LOC111136074 LOC111134548 LOC111134529 LOC111134531 LOC111134544 LOC111134435 LOC111134575 LOC111134203 LOC111135612 LOC111132554 LOC111135606 LOC111135601 LOC111135610 LOC111136831 LOC111135714 LOC111138076 LOC111137869 LOC111136895 LOC111137837 LOC111133659 LOC111137096 LOC111136889 LOC111134101 LOC111135710 LOC111136667 LOC111133641 LOC111134460 LOC111132949 LOC111133424 LOC111135494 LOC111134987 LOC111134982 LOC111134981 LOC111134984 LOC111101099 LOC111100025 LOC111102110 LOC111100620 LOC111101052 LOC111101010 LOC111101054 LOC111099547 LOC111100630 LOC111100051 LOC111100143 LOC111102307 LOC111100047 LOC111101484 LOC111101373 LOC111101035 LOC111100356 LOC111100347 LOC111100556 LOC111100963 LOC111100165 LOC111101289 LOC111103801 LOC111104066 LOC111104069 LOC111104068 LOC111104062 LOC111102475 LOC111102529 LOC111103059 LOC111104055 LOC111102798 LOC111103367 LOC111105074 LOC111103449 LOC111102719 LOC111104326 LOC111110684 LOC111110315 LOC111108691 LOC111106216 LOC111109578 LOC111107274 LOC111108081 LOC111108186 LOC111106650 LOC111108359 LOC111109272 LOC111110860 LOC111115931 LOC111112551 LOC111113393 LOC111115092 LOC111115117 LOC111114833 LOC111113408 LOC111111211 LOC111112807 LOC111112585 LOC111111339 LOC111114304 LOC111112160 LOC111117191 LOC111117016 

## Overlapping genes between Fst and lfmm2 with q-value fdr = 0.01
Overlapping SNPs for ShinyGO: 
LOC111111995 LOC111127416 LOC111128784 LOC111109321 LOC111137407 LOC111100849 LOC111136085 LOC111103542 LOC111128747 LOC111099049 LOC111135947 LOC111109612 LOC111134008 LOC111119911 LOC111119922 LOC111101232 LOC111114718 LOC111130039 LOC111119246 LOC111127875 LOC111102528 LOC111119701 LOC111102987 LOC111127225 LOC111135504 LOC111114174 LOC111132859 LOC111135003 LOC111129455 LOC111099775 LOC111131784 LOC111099143 LOC111135447 LOC111113431 LOC111119678 LOC111118916 LOC111120083 LOC111119193 LOC111119162 LOC111119400 LOC111121220 LOC111120642 LOC111118957 LOC111119579 LOC111120773 LOC111122374 LOC111119713 LOC111122413 LOC111121780 LOC111118137 LOC111120585 LOC111120660 LOC111118541 LOC111120701 LOC111120754 LOC111118275 LOC111122932 LOC111123201 LOC111123057 LOC111127509 LOC111127402 LOC111126343 LOC111125835 LOC111123544 LOC111122494 LOC111124862 LOC111123194 LOC111125881 LOC111127045 LOC111123699 LOC111125842 LOC111123254 LOC111123502 LOC111124621 LOC111123896 LOC111123090 LOC111122957 LOC111127338 LOC111126188 LOC111126391 LOC111125945 LOC111125808 LOC111126534 LOC111126439 LOC111122645 LOC111122700 LOC111122663 LOC111126735 LOC111124634 LOC111122815 LOC111122817 LOC111124019 LOC111124479 LOC111125145 LOC111122691 LOC111131137 LOC111130898 LOC111128509 LOC111129823 LOC111130020 LOC111129888 LOC111130884 LOC111130727 LOC111131153 LOC111129345 LOC111131386 LOC111129451 LOC111130954 LOC111129313 LOC111131077 LOC111129651 LOC111130852 LOC111129966 LOC111131875 LOC111128945 LOC111127829 LOC111131367 LOC111130444 LOC111130119 LOC111132955 LOC111135872 LOC111132034 LOC111136548 LOC111137562 LOC111135319 LOC111134058 LOC111134889 LOC111138450 LOC111133359 LOC111135286 LOC111136648 LOC111133865 LOC111132210 LOC111137552 LOC111137415 LOC111099173 LOC111133465 LOC111134696 LOC111132115 LOC111135484 LOC111137331 LOC111136615 LOC111138189 LOC111137299 LOC111136597 LOC111133449 LOC111136737 LOC111134718 LOC111132432 LOC111133033 LOC111138423 LOC111137699 LOC111132593 LOC111136384 LOC111135893 LOC111137313 LOC111135239 LOC111134722 LOC111137277 LOC111135363 LOC111137543 LOC111136669 LOC111134680 LOC111134834 LOC111135911 LOC111136074 LOC111134548 LOC111134529 LOC111134531 LOC111134544 LOC111134435 LOC111134575 LOC111134203 LOC111135612 LOC111132554 LOC111135606 LOC111135601 LOC111135610 LOC111136831 LOC111138076 LOC111136895 LOC111137837 LOC111133659 LOC111137096 LOC111136889 LOC111135710 LOC111136667 LOC111133641 LOC111135494 LOC111134987 LOC111134982 LOC111134981 LOC111101099 LOC111100025 LOC111102110 LOC111100620 LOC111101010 LOC111101054 LOC111099547 LOC111100630 LOC111100051 LOC111100143 LOC111102307 LOC111100047 LOC111101484 LOC111101035 LOC111100356 LOC111100347 LOC111100556 LOC111100963 LOC111100165 LOC111103801 LOC111104069 LOC111104068 LOC111104062 LOC111102475 LOC111104055 LOC111102798 LOC111105074 LOC111103449 LOC111102719 LOC111104326 LOC111110684 LOC111110315 LOC111108691 LOC111109578 LOC111107274 LOC111108081 LOC111108186 LOC111106650 LOC111108359 LOC111110860 LOC111115092 LOC111115117 LOC111114833 LOC111113408 LOC111111211 LOC111112807 LOC111112585 LOC111117191 LOC111117016 





